# -- modules
from lib.handler.fingerprint import *
from lib.handler.fullscan import *
from lib.utils.settings import *
from lib.handler.crawler import *
# -- lib
from lib.utils.usage import *


class wascan(object):
    """ WAScan """
    usage = usage()

    def main(self):
        kwargs = ARGS

        # starting
        url = 'http://www.takearth.com/XSS/index.php?id=1'
        parse = SplitURL(url)
        
        PTIME(url)
        Fingerprint(kwargs, url).run()

        current_url = None
        for u in Crawler().run(kwargs,url,kwargs['data']):
            current_url = u.split("?")[0]
            Attacks(kwargs, current_url+"?id=1", kwargs['data'])


wascan().main()
