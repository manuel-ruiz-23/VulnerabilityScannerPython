#!/usr/bin/env python 
# -*- coding:utf-8 -*-
#
# @name:    Wascan - Web Application Scanner
# @repo:    https://github.com/m4ll0k/Wascan
# @author:  Momo Outaadi (M4ll0k)
# @license: See the file 'LICENSE.txt'
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA

# --
import getopt

# -- modules
from lib.handler.crawler import *
from lib.handler.fingerprint import *
from lib.handler.fullscan import *
from lib.utils.exception import *
from lib.utils.settings import *
# -- lib
from lib.utils.usage import *


class wascan(object):
    """ WAScan """
    usage = usage()

    def main(self):
        kwargs = ARGS

        # starting
        url = 'http://www.takearth.com/XSS/index.php?id=1'
        parse = SplitURL(url)
        try:
            PTIME(url)

            Fingerprint(kwargs, url).run()
            Attacks(kwargs, url, kwargs['data'])

        except WascanUnboundLocalError, e:
            pass


if __name__ == "__main__":
    try:
        wascan().main()
    except KeyboardInterrupt, e:
        exit(warn('Exiting... :('))
